use std::array;

use num::PrimInt;
use register::register;

#[register]
fn run(input: &str) -> (usize, usize) {
    // The iteration process is cyclic:
    //
    //      3x3 -> 4x4        2x2 -> 3x3        2x2 -> 3x3
    // 3x3 ------------> 4x4 ------------> 6x6 ------------> 9x9
    //
    // From that point onward, each 3x3 subgrid of the 9x9 grid is independent.
    //
    // We also use the fact that, when looking at these three iterations as a
    // single step, at most 7 3x3 patterns are relevant: the starting pattern,
    // and the 6 patterns produced by the 2x2 -> 3x3 rules.
    let mut map_2x2_3x3 = [u16::MAX; 16];
    let mut map_3x3_4x4 = [[u8::MAX; 4]; 512];
    let start_3x3 = parse_3x3(b".#./..#/###");
    let mut relevant_3x3s = [start_3x3; 7];
    let mut num_3x3s = 1;
    for line in input.lines().map(str::as_bytes) {
        if line.len() == 20 {
            let from = parse_2x2(&line[..5]);
            let to = parse_3x3(&line[9..]);
            relevant_3x3s[num_3x3s] = to;
            num_3x3s += 1;
            for sym in SYMMETRY_2X2[usize::from(from)] {
                map_2x2_3x3[usize::from(sym)] = to;
            }
        } else {
            let from = parse_3x3(&line[..11]);
            let to = parse_4x4(&line[15..]);
            for sym in SYMMETRY_3X3[usize::from(from)] {
                map_3x3_4x4[usize::from(sym)] = to;
            }
        }
    }

    // We use coordinate compression for the relevant 3x3 patterns to reduce a
    // 512 vector of counts to a 7 vector.
    let map_3x3_9x9: [[_; 9]; 7] = relevant_3x3s.map(|i| {
        let mut g = [[false; 6]; 6];
        for (j, i2) in map_3x3_4x4[usize::from(i)].into_iter().enumerate() {
            let i3 = map_2x2_3x3[usize::from(i2)];
            for (k, b) in into_bits::<9>(i3).into_iter().enumerate() {
                g[j / 2 * 3 + k / 3][j % 2 * 3 + k % 3] = b;
            }
        }
        array::from_fn(|i| {
            let x = i / 3 * 2;
            let y = i % 3 * 2;
            let bits = [g[x][y], g[x][y + 1], g[x + 1][y], g[x + 1][y + 1]];
            let index3 = map_2x2_3x3[from_bits::<usize>(bits)];
            relevant_3x3s.iter().position(|&j| j == index3).unwrap() as u8
        })
    });

    let mut part1 = 0;
    for index in map_3x3_9x9[0] {
        let index = relevant_3x3s[usize::from(index)];
        for pat2 in map_3x3_4x4[usize::from(index)] {
            part1 += map_2x2_3x3[usize::from(pat2)].count_ones() as usize;
        }
    }

    let mut cnts = [0_usize; 7];
    cnts[0] = 1;
    for _ in 0..6 {
        let mut new_cnts = [0; 7];
        for (i, c) in cnts.into_iter().enumerate() {
            for j in map_3x3_9x9[i] {
                new_cnts[usize::from(j)] += c;
            }
        }
        cnts = new_cnts;
    }
    let part2 = cnts
        .into_iter()
        .zip(relevant_3x3s)
        .map(|(c, pat)| c * pat.count_ones() as usize)
        .sum();

    (part1, part2)
}

fn parse_2x2(input: &[u8]) -> u8 {
    parse_bits(input, [0, 1, 3, 4])
}

fn parse_3x3(input: &[u8]) -> u16 {
    parse_bits(input, [0, 1, 2, 4, 5, 6, 8, 9, 10])
}

fn parse_4x4(input: &[u8]) -> [u8; 4] {
    [
        [0, 1, 5, 6],
        [2, 3, 7, 8],
        [10, 11, 15, 16],
        [12, 13, 17, 18],
    ]
    .map(|indices| parse_bits(input, indices))
}

fn parse_bits<T: PrimInt + From<bool>>(
    input: &[u8],
    bit_indices: impl IntoIterator<Item = usize>,
) -> T {
    from_bits(bit_indices.into_iter().map(|i| input[i] == b'#'))
}

fn from_bits<T: PrimInt + From<bool>>(bits: impl IntoIterator<Item = bool>) -> T {
    bits.into_iter().fold(T::zero(), |j, b| (j << 1) | b.into())
}

fn into_bits<const N: usize>(index: impl Into<u64>) -> [bool; N] {
    let index = index.into();
    array::from_fn(|i| (index >> (N - 1 - i)) & 1 == 1)
}

const SYMMETRY_2X2: [[u8; 8]; 16] = [
    [0, 0, 0, 0, 0, 0, 0, 0],
    [1, 4, 2, 8, 8, 2, 4, 1],
    [2, 8, 8, 2, 4, 1, 1, 4],
    [3, 12, 10, 10, 12, 3, 5, 5],
    [4, 1, 1, 4, 2, 8, 8, 2],
    [5, 5, 3, 12, 10, 10, 12, 3],
    [6, 9, 9, 6, 6, 9, 9, 6],
    [7, 13, 11, 14, 14, 11, 13, 7],
    [8, 2, 4, 1, 1, 4, 2, 8],
    [9, 6, 6, 9, 9, 6, 6, 9],
    [10, 10, 12, 3, 5, 5, 3, 12],
    [11, 14, 14, 11, 13, 7, 7, 13],
    [12, 3, 5, 5, 3, 12, 10, 10],
    [13, 7, 7, 13, 11, 14, 14, 11],
    [14, 11, 13, 7, 7, 13, 11, 14],
    [15, 15, 15, 15, 15, 15, 15, 15],
];

const SYMMETRY_3X3: [[u16; 8]; 512] = [
    [0, 0, 0, 0, 0, 0, 0, 0],
    [1, 64, 4, 256, 256, 4, 64, 1],
    [2, 128, 32, 32, 128, 2, 8, 8],
    [3, 192, 36, 288, 384, 6, 72, 9],
    [4, 256, 256, 4, 64, 1, 1, 64],
    [5, 320, 260, 260, 320, 5, 65, 65],
    [6, 384, 288, 36, 192, 3, 9, 72],
    [7, 448, 292, 292, 448, 7, 73, 73],
    [8, 8, 2, 128, 32, 32, 128, 2],
    [9, 72, 6, 384, 288, 36, 192, 3],
    [10, 136, 34, 160, 160, 34, 136, 10],
    [11, 200, 38, 416, 416, 38, 200, 11],
    [12, 264, 258, 132, 96, 33, 129, 66],
    [13, 328, 262, 388, 352, 37, 193, 67],
    [14, 392, 290, 164, 224, 35, 137, 74],
    [15, 456, 294, 420, 480, 39, 201, 75],
    [16, 16, 16, 16, 16, 16, 16, 16],
    [17, 80, 20, 272, 272, 20, 80, 17],
    [18, 144, 48, 48, 144, 18, 24, 24],
    [19, 208, 52, 304, 400, 22, 88, 25],
    [20, 272, 272, 20, 80, 17, 17, 80],
    [21, 336, 276, 276, 336, 21, 81, 81],
    [22, 400, 304, 52, 208, 19, 25, 88],
    [23, 464, 308, 308, 464, 23, 89, 89],
    [24, 24, 18, 144, 48, 48, 144, 18],
    [25, 88, 22, 400, 304, 52, 208, 19],
    [26, 152, 50, 176, 176, 50, 152, 26],
    [27, 216, 54, 432, 432, 54, 216, 27],
    [28, 280, 274, 148, 112, 49, 145, 82],
    [29, 344, 278, 404, 368, 53, 209, 83],
    [30, 408, 306, 180, 240, 51, 153, 90],
    [31, 472, 310, 436, 496, 55, 217, 91],
    [32, 32, 128, 2, 8, 8, 2, 128],
    [33, 96, 132, 258, 264, 12, 66, 129],
    [34, 160, 160, 34, 136, 10, 10, 136],
    [35, 224, 164, 290, 392, 14, 74, 137],
    [36, 288, 384, 6, 72, 9, 3, 192],
    [37, 352, 388, 262, 328, 13, 67, 193],
    [38, 416, 416, 38, 200, 11, 11, 200],
    [39, 480, 420, 294, 456, 15, 75, 201],
    [40, 40, 130, 130, 40, 40, 130, 130],
    [41, 104, 134, 386, 296, 44, 194, 131],
    [42, 168, 162, 162, 168, 42, 138, 138],
    [43, 232, 166, 418, 424, 46, 202, 139],
    [44, 296, 386, 134, 104, 41, 131, 194],
    [45, 360, 390, 390, 360, 45, 195, 195],
    [46, 424, 418, 166, 232, 43, 139, 202],
    [47, 488, 422, 422, 488, 47, 203, 203],
    [48, 48, 144, 18, 24, 24, 18, 144],
    [49, 112, 148, 274, 280, 28, 82, 145],
    [50, 176, 176, 50, 152, 26, 26, 152],
    [51, 240, 180, 306, 408, 30, 90, 153],
    [52, 304, 400, 22, 88, 25, 19, 208],
    [53, 368, 404, 278, 344, 29, 83, 209],
    [54, 432, 432, 54, 216, 27, 27, 216],
    [55, 496, 436, 310, 472, 31, 91, 217],
    [56, 56, 146, 146, 56, 56, 146, 146],
    [57, 120, 150, 402, 312, 60, 210, 147],
    [58, 184, 178, 178, 184, 58, 154, 154],
    [59, 248, 182, 434, 440, 62, 218, 155],
    [60, 312, 402, 150, 120, 57, 147, 210],
    [61, 376, 406, 406, 376, 61, 211, 211],
    [62, 440, 434, 182, 248, 59, 155, 218],
    [63, 504, 438, 438, 504, 63, 219, 219],
    [64, 1, 1, 64, 4, 256, 256, 4],
    [65, 65, 5, 320, 260, 260, 320, 5],
    [66, 129, 33, 96, 132, 258, 264, 12],
    [67, 193, 37, 352, 388, 262, 328, 13],
    [68, 257, 257, 68, 68, 257, 257, 68],
    [69, 321, 261, 324, 324, 261, 321, 69],
    [70, 385, 289, 100, 196, 259, 265, 76],
    [71, 449, 293, 356, 452, 263, 329, 77],
    [72, 9, 3, 192, 36, 288, 384, 6],
    [73, 73, 7, 448, 292, 292, 448, 7],
    [74, 137, 35, 224, 164, 290, 392, 14],
    [75, 201, 39, 480, 420, 294, 456, 15],
    [76, 265, 259, 196, 100, 289, 385, 70],
    [77, 329, 263, 452, 356, 293, 449, 71],
    [78, 393, 291, 228, 228, 291, 393, 78],
    [79, 457, 295, 484, 484, 295, 457, 79],
    [80, 17, 17, 80, 20, 272, 272, 20],
    [81, 81, 21, 336, 276, 276, 336, 21],
    [82, 145, 49, 112, 148, 274, 280, 28],
    [83, 209, 53, 368, 404, 278, 344, 29],
    [84, 273, 273, 84, 84, 273, 273, 84],
    [85, 337, 277, 340, 340, 277, 337, 85],
    [86, 401, 305, 116, 212, 275, 281, 92],
    [87, 465, 309, 372, 468, 279, 345, 93],
    [88, 25, 19, 208, 52, 304, 400, 22],
    [89, 89, 23, 464, 308, 308, 464, 23],
    [90, 153, 51, 240, 180, 306, 408, 30],
    [91, 217, 55, 496, 436, 310, 472, 31],
    [92, 281, 275, 212, 116, 305, 401, 86],
    [93, 345, 279, 468, 372, 309, 465, 87],
    [94, 409, 307, 244, 244, 307, 409, 94],
    [95, 473, 311, 500, 500, 311, 473, 95],
    [96, 33, 129, 66, 12, 264, 258, 132],
    [97, 97, 133, 322, 268, 268, 322, 133],
    [98, 161, 161, 98, 140, 266, 266, 140],
    [99, 225, 165, 354, 396, 270, 330, 141],
    [100, 289, 385, 70, 76, 265, 259, 196],
    [101, 353, 389, 326, 332, 269, 323, 197],
    [102, 417, 417, 102, 204, 267, 267, 204],
    [103, 481, 421, 358, 460, 271, 331, 205],
    [104, 41, 131, 194, 44, 296, 386, 134],
    [105, 105, 135, 450, 300, 300, 450, 135],
    [106, 169, 163, 226, 172, 298, 394, 142],
    [107, 233, 167, 482, 428, 302, 458, 143],
    [108, 297, 387, 198, 108, 297, 387, 198],
    [109, 361, 391, 454, 364, 301, 451, 199],
    [110, 425, 419, 230, 236, 299, 395, 206],
    [111, 489, 423, 486, 492, 303, 459, 207],
    [112, 49, 145, 82, 28, 280, 274, 148],
    [113, 113, 149, 338, 284, 284, 338, 149],
    [114, 177, 177, 114, 156, 282, 282, 156],
    [115, 241, 181, 370, 412, 286, 346, 157],
    [116, 305, 401, 86, 92, 281, 275, 212],
    [117, 369, 405, 342, 348, 285, 339, 213],
    [118, 433, 433, 118, 220, 283, 283, 220],
    [119, 497, 437, 374, 476, 287, 347, 221],
    [120, 57, 147, 210, 60, 312, 402, 150],
    [121, 121, 151, 466, 316, 316, 466, 151],
    [122, 185, 179, 242, 188, 314, 410, 158],
    [123, 249, 183, 498, 444, 318, 474, 159],
    [124, 313, 403, 214, 124, 313, 403, 214],
    [125, 377, 407, 470, 380, 317, 467, 215],
    [126, 441, 435, 246, 252, 315, 411, 222],
    [127, 505, 439, 502, 508, 319, 475, 223],
    [128, 2, 8, 8, 2, 128, 32, 32],
    [129, 66, 12, 264, 258, 132, 96, 33],
    [130, 130, 40, 40, 130, 130, 40, 40],
    [131, 194, 44, 296, 386, 134, 104, 41],
    [132, 258, 264, 12, 66, 129, 33, 96],
    [133, 322, 268, 268, 322, 133, 97, 97],
    [134, 386, 296, 44, 194, 131, 41, 104],
    [135, 450, 300, 300, 450, 135, 105, 105],
    [136, 10, 10, 136, 34, 160, 160, 34],
    [137, 74, 14, 392, 290, 164, 224, 35],
    [138, 138, 42, 168, 162, 162, 168, 42],
    [139, 202, 46, 424, 418, 166, 232, 43],
    [140, 266, 266, 140, 98, 161, 161, 98],
    [141, 330, 270, 396, 354, 165, 225, 99],
    [142, 394, 298, 172, 226, 163, 169, 106],
    [143, 458, 302, 428, 482, 167, 233, 107],
    [144, 18, 24, 24, 18, 144, 48, 48],
    [145, 82, 28, 280, 274, 148, 112, 49],
    [146, 146, 56, 56, 146, 146, 56, 56],
    [147, 210, 60, 312, 402, 150, 120, 57],
    [148, 274, 280, 28, 82, 145, 49, 112],
    [149, 338, 284, 284, 338, 149, 113, 113],
    [150, 402, 312, 60, 210, 147, 57, 120],
    [151, 466, 316, 316, 466, 151, 121, 121],
    [152, 26, 26, 152, 50, 176, 176, 50],
    [153, 90, 30, 408, 306, 180, 240, 51],
    [154, 154, 58, 184, 178, 178, 184, 58],
    [155, 218, 62, 440, 434, 182, 248, 59],
    [156, 282, 282, 156, 114, 177, 177, 114],
    [157, 346, 286, 412, 370, 181, 241, 115],
    [158, 410, 314, 188, 242, 179, 185, 122],
    [159, 474, 318, 444, 498, 183, 249, 123],
    [160, 34, 136, 10, 10, 136, 34, 160],
    [161, 98, 140, 266, 266, 140, 98, 161],
    [162, 162, 168, 42, 138, 138, 42, 168],
    [163, 226, 172, 298, 394, 142, 106, 169],
    [164, 290, 392, 14, 74, 137, 35, 224],
    [165, 354, 396, 270, 330, 141, 99, 225],
    [166, 418, 424, 46, 202, 139, 43, 232],
    [167, 482, 428, 302, 458, 143, 107, 233],
    [168, 42, 138, 138, 42, 168, 162, 162],
    [169, 106, 142, 394, 298, 172, 226, 163],
    [170, 170, 170, 170, 170, 170, 170, 170],
    [171, 234, 174, 426, 426, 174, 234, 171],
    [172, 298, 394, 142, 106, 169, 163, 226],
    [173, 362, 398, 398, 362, 173, 227, 227],
    [174, 426, 426, 174, 234, 171, 171, 234],
    [175, 490, 430, 430, 490, 175, 235, 235],
    [176, 50, 152, 26, 26, 152, 50, 176],
    [177, 114, 156, 282, 282, 156, 114, 177],
    [178, 178, 184, 58, 154, 154, 58, 184],
    [179, 242, 188, 314, 410, 158, 122, 185],
    [180, 306, 408, 30, 90, 153, 51, 240],
    [181, 370, 412, 286, 346, 157, 115, 241],
    [182, 434, 440, 62, 218, 155, 59, 248],
    [183, 498, 444, 318, 474, 159, 123, 249],
    [184, 58, 154, 154, 58, 184, 178, 178],
    [185, 122, 158, 410, 314, 188, 242, 179],
    [186, 186, 186, 186, 186, 186, 186, 186],
    [187, 250, 190, 442, 442, 190, 250, 187],
    [188, 314, 410, 158, 122, 185, 179, 242],
    [189, 378, 414, 414, 378, 189, 243, 243],
    [190, 442, 442, 190, 250, 187, 187, 250],
    [191, 506, 446, 446, 506, 191, 251, 251],
    [192, 3, 9, 72, 6, 384, 288, 36],
    [193, 67, 13, 328, 262, 388, 352, 37],
    [194, 131, 41, 104, 134, 386, 296, 44],
    [195, 195, 45, 360, 390, 390, 360, 45],
    [196, 259, 265, 76, 70, 385, 289, 100],
    [197, 323, 269, 332, 326, 389, 353, 101],
    [198, 387, 297, 108, 198, 387, 297, 108],
    [199, 451, 301, 364, 454, 391, 361, 109],
    [200, 11, 11, 200, 38, 416, 416, 38],
    [201, 75, 15, 456, 294, 420, 480, 39],
    [202, 139, 43, 232, 166, 418, 424, 46],
    [203, 203, 47, 488, 422, 422, 488, 47],
    [204, 267, 267, 204, 102, 417, 417, 102],
    [205, 331, 271, 460, 358, 421, 481, 103],
    [206, 395, 299, 236, 230, 419, 425, 110],
    [207, 459, 303, 492, 486, 423, 489, 111],
    [208, 19, 25, 88, 22, 400, 304, 52],
    [209, 83, 29, 344, 278, 404, 368, 53],
    [210, 147, 57, 120, 150, 402, 312, 60],
    [211, 211, 61, 376, 406, 406, 376, 61],
    [212, 275, 281, 92, 86, 401, 305, 116],
    [213, 339, 285, 348, 342, 405, 369, 117],
    [214, 403, 313, 124, 214, 403, 313, 124],
    [215, 467, 317, 380, 470, 407, 377, 125],
    [216, 27, 27, 216, 54, 432, 432, 54],
    [217, 91, 31, 472, 310, 436, 496, 55],
    [218, 155, 59, 248, 182, 434, 440, 62],
    [219, 219, 63, 504, 438, 438, 504, 63],
    [220, 283, 283, 220, 118, 433, 433, 118],
    [221, 347, 287, 476, 374, 437, 497, 119],
    [222, 411, 315, 252, 246, 435, 441, 126],
    [223, 475, 319, 508, 502, 439, 505, 127],
    [224, 35, 137, 74, 14, 392, 290, 164],
    [225, 99, 141, 330, 270, 396, 354, 165],
    [226, 163, 169, 106, 142, 394, 298, 172],
    [227, 227, 173, 362, 398, 398, 362, 173],
    [228, 291, 393, 78, 78, 393, 291, 228],
    [229, 355, 397, 334, 334, 397, 355, 229],
    [230, 419, 425, 110, 206, 395, 299, 236],
    [231, 483, 429, 366, 462, 399, 363, 237],
    [232, 43, 139, 202, 46, 424, 418, 166],
    [233, 107, 143, 458, 302, 428, 482, 167],
    [234, 171, 171, 234, 174, 426, 426, 174],
    [235, 235, 175, 490, 430, 430, 490, 175],
    [236, 299, 395, 206, 110, 425, 419, 230],
    [237, 363, 399, 462, 366, 429, 483, 231],
    [238, 427, 427, 238, 238, 427, 427, 238],
    [239, 491, 431, 494, 494, 431, 491, 239],
    [240, 51, 153, 90, 30, 408, 306, 180],
    [241, 115, 157, 346, 286, 412, 370, 181],
    [242, 179, 185, 122, 158, 410, 314, 188],
    [243, 243, 189, 378, 414, 414, 378, 189],
    [244, 307, 409, 94, 94, 409, 307, 244],
    [245, 371, 413, 350, 350, 413, 371, 245],
    [246, 435, 441, 126, 222, 411, 315, 252],
    [247, 499, 445, 382, 478, 415, 379, 253],
    [248, 59, 155, 218, 62, 440, 434, 182],
    [249, 123, 159, 474, 318, 444, 498, 183],
    [250, 187, 187, 250, 190, 442, 442, 190],
    [251, 251, 191, 506, 446, 446, 506, 191],
    [252, 315, 411, 222, 126, 441, 435, 246],
    [253, 379, 415, 478, 382, 445, 499, 247],
    [254, 443, 443, 254, 254, 443, 443, 254],
    [255, 507, 447, 510, 510, 447, 507, 255],
    [256, 4, 64, 1, 1, 64, 4, 256],
    [257, 68, 68, 257, 257, 68, 68, 257],
    [258, 132, 96, 33, 129, 66, 12, 264],
    [259, 196, 100, 289, 385, 70, 76, 265],
    [260, 260, 320, 5, 65, 65, 5, 320],
    [261, 324, 324, 261, 321, 69, 69, 321],
    [262, 388, 352, 37, 193, 67, 13, 328],
    [263, 452, 356, 293, 449, 71, 77, 329],
    [264, 12, 66, 129, 33, 96, 132, 258],
    [265, 76, 70, 385, 289, 100, 196, 259],
    [266, 140, 98, 161, 161, 98, 140, 266],
    [267, 204, 102, 417, 417, 102, 204, 267],
    [268, 268, 322, 133, 97, 97, 133, 322],
    [269, 332, 326, 389, 353, 101, 197, 323],
    [270, 396, 354, 165, 225, 99, 141, 330],
    [271, 460, 358, 421, 481, 103, 205, 331],
    [272, 20, 80, 17, 17, 80, 20, 272],
    [273, 84, 84, 273, 273, 84, 84, 273],
    [274, 148, 112, 49, 145, 82, 28, 280],
    [275, 212, 116, 305, 401, 86, 92, 281],
    [276, 276, 336, 21, 81, 81, 21, 336],
    [277, 340, 340, 277, 337, 85, 85, 337],
    [278, 404, 368, 53, 209, 83, 29, 344],
    [279, 468, 372, 309, 465, 87, 93, 345],
    [280, 28, 82, 145, 49, 112, 148, 274],
    [281, 92, 86, 401, 305, 116, 212, 275],
    [282, 156, 114, 177, 177, 114, 156, 282],
    [283, 220, 118, 433, 433, 118, 220, 283],
    [284, 284, 338, 149, 113, 113, 149, 338],
    [285, 348, 342, 405, 369, 117, 213, 339],
    [286, 412, 370, 181, 241, 115, 157, 346],
    [287, 476, 374, 437, 497, 119, 221, 347],
    [288, 36, 192, 3, 9, 72, 6, 384],
    [289, 100, 196, 259, 265, 76, 70, 385],
    [290, 164, 224, 35, 137, 74, 14, 392],
    [291, 228, 228, 291, 393, 78, 78, 393],
    [292, 292, 448, 7, 73, 73, 7, 448],
    [293, 356, 452, 263, 329, 77, 71, 449],
    [294, 420, 480, 39, 201, 75, 15, 456],
    [295, 484, 484, 295, 457, 79, 79, 457],
    [296, 44, 194, 131, 41, 104, 134, 386],
    [297, 108, 198, 387, 297, 108, 198, 387],
    [298, 172, 226, 163, 169, 106, 142, 394],
    [299, 236, 230, 419, 425, 110, 206, 395],
    [300, 300, 450, 135, 105, 105, 135, 450],
    [301, 364, 454, 391, 361, 109, 199, 451],
    [302, 428, 482, 167, 233, 107, 143, 458],
    [303, 492, 486, 423, 489, 111, 207, 459],
    [304, 52, 208, 19, 25, 88, 22, 400],
    [305, 116, 212, 275, 281, 92, 86, 401],
    [306, 180, 240, 51, 153, 90, 30, 408],
    [307, 244, 244, 307, 409, 94, 94, 409],
    [308, 308, 464, 23, 89, 89, 23, 464],
    [309, 372, 468, 279, 345, 93, 87, 465],
    [310, 436, 496, 55, 217, 91, 31, 472],
    [311, 500, 500, 311, 473, 95, 95, 473],
    [312, 60, 210, 147, 57, 120, 150, 402],
    [313, 124, 214, 403, 313, 124, 214, 403],
    [314, 188, 242, 179, 185, 122, 158, 410],
    [315, 252, 246, 435, 441, 126, 222, 411],
    [316, 316, 466, 151, 121, 121, 151, 466],
    [317, 380, 470, 407, 377, 125, 215, 467],
    [318, 444, 498, 183, 249, 123, 159, 474],
    [319, 508, 502, 439, 505, 127, 223, 475],
    [320, 5, 65, 65, 5, 320, 260, 260],
    [321, 69, 69, 321, 261, 324, 324, 261],
    [322, 133, 97, 97, 133, 322, 268, 268],
    [323, 197, 101, 353, 389, 326, 332, 269],
    [324, 261, 321, 69, 69, 321, 261, 324],
    [325, 325, 325, 325, 325, 325, 325, 325],
    [326, 389, 353, 101, 197, 323, 269, 332],
    [327, 453, 357, 357, 453, 327, 333, 333],
    [328, 13, 67, 193, 37, 352, 388, 262],
    [329, 77, 71, 449, 293, 356, 452, 263],
    [330, 141, 99, 225, 165, 354, 396, 270],
    [331, 205, 103, 481, 421, 358, 460, 271],
    [332, 269, 323, 197, 101, 353, 389, 326],
    [333, 333, 327, 453, 357, 357, 453, 327],
    [334, 397, 355, 229, 229, 355, 397, 334],
    [335, 461, 359, 485, 485, 359, 461, 335],
    [336, 21, 81, 81, 21, 336, 276, 276],
    [337, 85, 85, 337, 277, 340, 340, 277],
    [338, 149, 113, 113, 149, 338, 284, 284],
    [339, 213, 117, 369, 405, 342, 348, 285],
    [340, 277, 337, 85, 85, 337, 277, 340],
    [341, 341, 341, 341, 341, 341, 341, 341],
    [342, 405, 369, 117, 213, 339, 285, 348],
    [343, 469, 373, 373, 469, 343, 349, 349],
    [344, 29, 83, 209, 53, 368, 404, 278],
    [345, 93, 87, 465, 309, 372, 468, 279],
    [346, 157, 115, 241, 181, 370, 412, 286],
    [347, 221, 119, 497, 437, 374, 476, 287],
    [348, 285, 339, 213, 117, 369, 405, 342],
    [349, 349, 343, 469, 373, 373, 469, 343],
    [350, 413, 371, 245, 245, 371, 413, 350],
    [351, 477, 375, 501, 501, 375, 477, 351],
    [352, 37, 193, 67, 13, 328, 262, 388],
    [353, 101, 197, 323, 269, 332, 326, 389],
    [354, 165, 225, 99, 141, 330, 270, 396],
    [355, 229, 229, 355, 397, 334, 334, 397],
    [356, 293, 449, 71, 77, 329, 263, 452],
    [357, 357, 453, 327, 333, 333, 327, 453],
    [358, 421, 481, 103, 205, 331, 271, 460],
    [359, 485, 485, 359, 461, 335, 335, 461],
    [360, 45, 195, 195, 45, 360, 390, 390],
    [361, 109, 199, 451, 301, 364, 454, 391],
    [362, 173, 227, 227, 173, 362, 398, 398],
    [363, 237, 231, 483, 429, 366, 462, 399],
    [364, 301, 451, 199, 109, 361, 391, 454],
    [365, 365, 455, 455, 365, 365, 455, 455],
    [366, 429, 483, 231, 237, 363, 399, 462],
    [367, 493, 487, 487, 493, 367, 463, 463],
    [368, 53, 209, 83, 29, 344, 278, 404],
    [369, 117, 213, 339, 285, 348, 342, 405],
    [370, 181, 241, 115, 157, 346, 286, 412],
    [371, 245, 245, 371, 413, 350, 350, 413],
    [372, 309, 465, 87, 93, 345, 279, 468],
    [373, 373, 469, 343, 349, 349, 343, 469],
    [374, 437, 497, 119, 221, 347, 287, 476],
    [375, 501, 501, 375, 477, 351, 351, 477],
    [376, 61, 211, 211, 61, 376, 406, 406],
    [377, 125, 215, 467, 317, 380, 470, 407],
    [378, 189, 243, 243, 189, 378, 414, 414],
    [379, 253, 247, 499, 445, 382, 478, 415],
    [380, 317, 467, 215, 125, 377, 407, 470],
    [381, 381, 471, 471, 381, 381, 471, 471],
    [382, 445, 499, 247, 253, 379, 415, 478],
    [383, 509, 503, 503, 509, 383, 479, 479],
    [384, 6, 72, 9, 3, 192, 36, 288],
    [385, 70, 76, 265, 259, 196, 100, 289],
    [386, 134, 104, 41, 131, 194, 44, 296],
    [387, 198, 108, 297, 387, 198, 108, 297],
    [388, 262, 328, 13, 67, 193, 37, 352],
    [389, 326, 332, 269, 323, 197, 101, 353],
    [390, 390, 360, 45, 195, 195, 45, 360],
    [391, 454, 364, 301, 451, 199, 109, 361],
    [392, 14, 74, 137, 35, 224, 164, 290],
    [393, 78, 78, 393, 291, 228, 228, 291],
    [394, 142, 106, 169, 163, 226, 172, 298],
    [395, 206, 110, 425, 419, 230, 236, 299],
    [396, 270, 330, 141, 99, 225, 165, 354],
    [397, 334, 334, 397, 355, 229, 229, 355],
    [398, 398, 362, 173, 227, 227, 173, 362],
    [399, 462, 366, 429, 483, 231, 237, 363],
    [400, 22, 88, 25, 19, 208, 52, 304],
    [401, 86, 92, 281, 275, 212, 116, 305],
    [402, 150, 120, 57, 147, 210, 60, 312],
    [403, 214, 124, 313, 403, 214, 124, 313],
    [404, 278, 344, 29, 83, 209, 53, 368],
    [405, 342, 348, 285, 339, 213, 117, 369],
    [406, 406, 376, 61, 211, 211, 61, 376],
    [407, 470, 380, 317, 467, 215, 125, 377],
    [408, 30, 90, 153, 51, 240, 180, 306],
    [409, 94, 94, 409, 307, 244, 244, 307],
    [410, 158, 122, 185, 179, 242, 188, 314],
    [411, 222, 126, 441, 435, 246, 252, 315],
    [412, 286, 346, 157, 115, 241, 181, 370],
    [413, 350, 350, 413, 371, 245, 245, 371],
    [414, 414, 378, 189, 243, 243, 189, 378],
    [415, 478, 382, 445, 499, 247, 253, 379],
    [416, 38, 200, 11, 11, 200, 38, 416],
    [417, 102, 204, 267, 267, 204, 102, 417],
    [418, 166, 232, 43, 139, 202, 46, 424],
    [419, 230, 236, 299, 395, 206, 110, 425],
    [420, 294, 456, 15, 75, 201, 39, 480],
    [421, 358, 460, 271, 331, 205, 103, 481],
    [422, 422, 488, 47, 203, 203, 47, 488],
    [423, 486, 492, 303, 459, 207, 111, 489],
    [424, 46, 202, 139, 43, 232, 166, 418],
    [425, 110, 206, 395, 299, 236, 230, 419],
    [426, 174, 234, 171, 171, 234, 174, 426],
    [427, 238, 238, 427, 427, 238, 238, 427],
    [428, 302, 458, 143, 107, 233, 167, 482],
    [429, 366, 462, 399, 363, 237, 231, 483],
    [430, 430, 490, 175, 235, 235, 175, 490],
    [431, 494, 494, 431, 491, 239, 239, 491],
    [432, 54, 216, 27, 27, 216, 54, 432],
    [433, 118, 220, 283, 283, 220, 118, 433],
    [434, 182, 248, 59, 155, 218, 62, 440],
    [435, 246, 252, 315, 411, 222, 126, 441],
    [436, 310, 472, 31, 91, 217, 55, 496],
    [437, 374, 476, 287, 347, 221, 119, 497],
    [438, 438, 504, 63, 219, 219, 63, 504],
    [439, 502, 508, 319, 475, 223, 127, 505],
    [440, 62, 218, 155, 59, 248, 182, 434],
    [441, 126, 222, 411, 315, 252, 246, 435],
    [442, 190, 250, 187, 187, 250, 190, 442],
    [443, 254, 254, 443, 443, 254, 254, 443],
    [444, 318, 474, 159, 123, 249, 183, 498],
    [445, 382, 478, 415, 379, 253, 247, 499],
    [446, 446, 506, 191, 251, 251, 191, 506],
    [447, 510, 510, 447, 507, 255, 255, 507],
    [448, 7, 73, 73, 7, 448, 292, 292],
    [449, 71, 77, 329, 263, 452, 356, 293],
    [450, 135, 105, 105, 135, 450, 300, 300],
    [451, 199, 109, 361, 391, 454, 364, 301],
    [452, 263, 329, 77, 71, 449, 293, 356],
    [453, 327, 333, 333, 327, 453, 357, 357],
    [454, 391, 361, 109, 199, 451, 301, 364],
    [455, 455, 365, 365, 455, 455, 365, 365],
    [456, 15, 75, 201, 39, 480, 420, 294],
    [457, 79, 79, 457, 295, 484, 484, 295],
    [458, 143, 107, 233, 167, 482, 428, 302],
    [459, 207, 111, 489, 423, 486, 492, 303],
    [460, 271, 331, 205, 103, 481, 421, 358],
    [461, 335, 335, 461, 359, 485, 485, 359],
    [462, 399, 363, 237, 231, 483, 429, 366],
    [463, 463, 367, 493, 487, 487, 493, 367],
    [464, 23, 89, 89, 23, 464, 308, 308],
    [465, 87, 93, 345, 279, 468, 372, 309],
    [466, 151, 121, 121, 151, 466, 316, 316],
    [467, 215, 125, 377, 407, 470, 380, 317],
    [468, 279, 345, 93, 87, 465, 309, 372],
    [469, 343, 349, 349, 343, 469, 373, 373],
    [470, 407, 377, 125, 215, 467, 317, 380],
    [471, 471, 381, 381, 471, 471, 381, 381],
    [472, 31, 91, 217, 55, 496, 436, 310],
    [473, 95, 95, 473, 311, 500, 500, 311],
    [474, 159, 123, 249, 183, 498, 444, 318],
    [475, 223, 127, 505, 439, 502, 508, 319],
    [476, 287, 347, 221, 119, 497, 437, 374],
    [477, 351, 351, 477, 375, 501, 501, 375],
    [478, 415, 379, 253, 247, 499, 445, 382],
    [479, 479, 383, 509, 503, 503, 509, 383],
    [480, 39, 201, 75, 15, 456, 294, 420],
    [481, 103, 205, 331, 271, 460, 358, 421],
    [482, 167, 233, 107, 143, 458, 302, 428],
    [483, 231, 237, 363, 399, 462, 366, 429],
    [484, 295, 457, 79, 79, 457, 295, 484],
    [485, 359, 461, 335, 335, 461, 359, 485],
    [486, 423, 489, 111, 207, 459, 303, 492],
    [487, 487, 493, 367, 463, 463, 367, 493],
    [488, 47, 203, 203, 47, 488, 422, 422],
    [489, 111, 207, 459, 303, 492, 486, 423],
    [490, 175, 235, 235, 175, 490, 430, 430],
    [491, 239, 239, 491, 431, 494, 494, 431],
    [492, 303, 459, 207, 111, 489, 423, 486],
    [493, 367, 463, 463, 367, 493, 487, 487],
    [494, 431, 491, 239, 239, 491, 431, 494],
    [495, 495, 495, 495, 495, 495, 495, 495],
    [496, 55, 217, 91, 31, 472, 310, 436],
    [497, 119, 221, 347, 287, 476, 374, 437],
    [498, 183, 249, 123, 159, 474, 318, 444],
    [499, 247, 253, 379, 415, 478, 382, 445],
    [500, 311, 473, 95, 95, 473, 311, 500],
    [501, 375, 477, 351, 351, 477, 375, 501],
    [502, 439, 505, 127, 223, 475, 319, 508],
    [503, 503, 509, 383, 479, 479, 383, 509],
    [504, 63, 219, 219, 63, 504, 438, 438],
    [505, 127, 223, 475, 319, 508, 502, 439],
    [506, 191, 251, 251, 191, 506, 446, 446],
    [507, 255, 255, 507, 447, 510, 510, 447],
    [508, 319, 475, 223, 127, 505, 439, 502],
    [509, 383, 479, 479, 383, 509, 503, 503],
    [510, 447, 507, 255, 255, 507, 447, 510],
    [511, 511, 511, 511, 511, 511, 511, 511],
];
